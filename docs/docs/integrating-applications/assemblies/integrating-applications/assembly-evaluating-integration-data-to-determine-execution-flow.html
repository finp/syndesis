<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Evaluating integration data to determine the execution flow :: Docs</title>
    <meta name="generator" content="Antora 2.3.1">
    <link rel="stylesheet" href="../../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
         
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="is-primary" href="#"></a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../../index.html">Docs</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../index.html"> Home</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Docs</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../index.html">Docs</a></li>
    <li><a href="assembly-evaluating-integration-data-to-determine-execution-flow.html">Evaluating integration data to determine the execution flow</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/pwright/repos/doc-test/syndesis/antora/modules/ROOT/pages/integrating-applications/assemblies/integrating-applications/assembly-evaluating-integration-data-to-determine-execution-flow.adoc"></a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Evaluating integration data to determine the execution flow</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In a flow, a <strong>Conditional Flows</strong> step evaluates integration data
against conditions that you specify. For each specified condition,
you add connections and other steps to the flow associated with
that condition. During execution, a <strong>Conditional Flows</strong> step
evaluates incoming data to determine which flow to execute.</p>
</div>
<div class="paragraph">
<p>The following topics provide details:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#behavior-of-conditional-flows-step_condition">Behavior of a <strong>Conditional Flows</strong> step</a></p>
</li>
<li>
<p><a href="#example-of-a-conditional-flows-step_condition">Example of a <strong>Conditional Flows</strong> step</a></p>
</li>
<li>
<p><a href="#general-procedure-for-configuring-conditional-flows-step_condition">General procedure for configuring a <strong>Conditional Flows</strong> step</a></p>
</li>
<li>
<p><a href="#using-basic-expression-builder_condition">Using the basic expression builder to specify conditions</a></p>
</li>
<li>
<p><a href="#using-advanced-expression-builder_condition">Using the advanced expression builder to specify conditions</a></p>
</li>
<li>
<p><a href="#adding-steps-to-conditional-flows_condition">Adding steps to conditional flows</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="behavior-of-conditional-flows-step_condition"><a class="anchor" href="#behavior-of-conditional-flows-step_condition"></a>Behavior of a <strong>Conditional Flows</strong> step</h2>
<div class="sectionbody">
<div class="paragraph">
<p>During integration development, you can add a <strong>Conditional Flows</strong> step to
a flow and define one or more conditions. For each condition, you add steps
to a conditional flow that is associated with only that condition.
During integration execution, for each message that the previous
integration step passes to a <strong>Conditional Flows</strong> step, the <strong>Conditional Flows</strong>
step evaluates the message content against the specified conditions in
the order in which you define them in the {prodname} page for specifying
conditions.</p>
</div>
<div class="paragraph">
<p>In a <strong>Conditional Flows</strong> step, the behavior is one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For the first condition that evaluates to true, the integration executes
the conditional flow that is associated with that condition.</p>
</li>
<li>
<p>If no conditions evaluate to true, and there is a default conditional flow,
the integration executes that flow.</p>
</li>
<li>
<p>If no conditions evaluate to true and there is no default conditional flow,
the integration does not execute a conditional flow.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After executing a conditional flow, or after no conditions evaluate
to true and there is no default conditional flow, the integration
executes the next step in the primary flow.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="example-of-a-conditional-flows-step_condition"><a class="anchor" href="#example-of-a-conditional-flows-step_condition"></a>Example of a <strong>Conditional Flows</strong> step</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Suppose that an integration connects to a SQL database to
obtain information about how much paid-time-off (PTO) each
employee has. The returned data indicates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Some employees might lose PTO if they do not use it by a certain date.</p>
</li>
<li>
<p>Other employees already used more PTO than they earned.</p>
</li>
<li>
<p>The rest of the employees have PTO that they can use without time restrictions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In a <strong>Conditional Flows</strong> step, this example integration can define two
conditions, an execution flow for each condition, and a default
execution flow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When PTO is greater than some number, it indicates that some PTO
might be lost if not used by a certain date. When this condition
evaluates to true, the integration executes
a flow that sends email to affected employees. The email contains the
amount of PTO that must be used and the date by which it must
be used.</p>
</li>
<li>
<p>When PTO is a negative number, it indicates that some PTO has been
used but not earned. When this condition evaluates to true, the
integration executes a flow that sends
an email to affected employees. The email contains the amount of PTO that the
employee has overdrawn and specifies the date on which the employee begins
to accrue PTO again.</p>
</li>
<li>
<p>When neither of the two conditions evaluates to true, the integration
executes the default flow. This example integration executes the default conditional flow for
employees whose PTO is neither a negative number nor above some specified number.
The default flow sends an email to those employees with a statement of the
amount of PTO that the employee has.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="general-procedure-for-configuring-conditional-flows-step_condition"><a class="anchor" href="#general-procedure-for-configuring-conditional-flows-step_condition"></a>General procedure for configuring a <strong>Conditional Flows</strong> step</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After you add a <strong>Conditional Flows</strong> step to a flow, the workflow
for configuring the step is as shown in the following image:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../_images/images/integrating-applications/WorkflowForConfiguringConditionalFlowsStep.png" alt="Workflow for configuring Conditional Flows step"></span></p>
</div>
<div class="ulist">
<div class="title">More about the workflow</div>
<ul>
<li>
<p>The basic expression builder prompts you for the property that contains the
content that you want to evaluate, and the condition and value that you want
to test for. The basic expression builder is suitable for most <strong>Conditional Flows</strong> steps.</p>
</li>
<li>
<p>The advanced expression builder lets you specify a conditional
expression in Camel Simple Language.</p>
</li>
<li>
<p>You must use the same expression builder for all conditions.
In other words, to configure a <strong>Conditional Flows</strong> step, you must use the
basic expression builder or the advanced expression builder. You cannot use both.</p>
</li>
<li>
<p>In a conditional flow, you cannot add a <strong>Conditional Flows</strong> step.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-basic-expression-builder_condition"><a class="anchor" href="#using-basic-expression-builder_condition"></a>Using the basic expression builder to specify conditions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In a flow, add a <strong>Conditional Flows</strong> step when you want to evaluate
incoming data to determine the integration&#8217;s execution path. The procedure
described here shows how to use the basic expression builder to
specify conditions.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You are creating or editing a primary flow. If this is a simple integration,
the start and finish connections have been added.</p>
</li>
<li>
<p>Input to a <strong>Conditional Flows</strong> step
must be an individual message. In the integration visualization,
if the previous step&#8217;s <strong>Data Type</strong> shows <strong>(Collection)</strong>, add a <strong>Split</strong> step
after the previous step and before this <strong>Conditional Flows</strong> step.</p>
</li>
<li>
<p>You are familiar with the fields that will be in the messages that the
integration passes to the <strong>Conditional Flows</strong> step you are about to add.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the integration visualization, where you want to add a <strong>Conditional Flows</strong> step,
click <span class="image"><img src="../../../_images/images/integrating-applications/PlusSignToAddStepOrConnection.png" alt="PlusSignToAddStepOrConnection" title="plus sign"></span>.</p>
</li>
<li>
<p>Click <strong>Conditional Flows</strong>.</p>
</li>
<li>
<p>Click <strong>Select</strong> in the <strong>Basic expression builder</strong> entry.</p>
</li>
<li>
<p>In the <strong>Configure Conditional Flows</strong> page, define one or more conditions:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click in the initial <strong>When</strong> field.</p>
</li>
<li>
<p>In the list of properties, click the property that contains the
content that you want the <strong>Conditional Flows</strong> step to evaluate.</p>
</li>
<li>
<p>In the next field, accept <strong>Contains</strong> as the condition for which
the step evaluates the data or select another condition.
The condition that you select in this field must evaluate to
true for the value that you enter in the next field.</p>
</li>
<li>
<p>In the third field, specify the value that the condition tests for.</p>
</li>
<li>
<p>Optional. Click <strong>Add another condition</strong> to specify another condition.</p>
</li>
<li>
<p>Repeat this set of steps for each additional condition that you want to define.</p>
</li>
<li>
<p>Optional. Change the order in which the integration evaluates
the defined conditions by clicking the up or down arrow to the right of a
condition.</p>
</li>
<li>
<p>Optional. Click <strong>Execute default flow</strong> if you want there to be a
default conditional flow.</p>
<div class="paragraph">
<p>If you select <strong>Execute default flow</strong>, during execution,
if none of the conditions that you specified evaluates
to true, the integration executes the default conditional flow. If you do
not select <strong>Execute default flow</strong>, during execution, if none of the
conditions that you specified evaluates to true, the integration continues
execution with the step that follows this <strong>Conditional Flows</strong> step.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>Next</strong>.</p>
</li>
<li>
<p>Optional. Specify the output data type if {prodname} prompts for it.
All conditional flows that are part of this <strong>Conditional Flows</strong> step
must have the same output type.</p>
</li>
<li>
<p>Click <strong>Next</strong>.</p>
<div class="paragraph">
<p>{prodname} displays the flow visualization. Below the <strong>Conditional Flows</strong> step
that you are adding, there is an entry for each condition that you specified,
as well as an entry for an <strong>Otherwise</strong> default flow if you indicated that the
<strong>Conditional Flows</strong> step has a default flow.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Next step</div>
<p>For each condition, add steps to its associated flow. If there is a default flow,
add steps to the default flow.</p>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For details about the conditions that you can select in the middle field
for each condition, see
<a href="https://camel.apache.org/manual/latest/simple-language.html#_operator_support">Camel Simple Language operators</a>.
Note that the <strong>matches</strong> condition corresponds to the Simple Language
<strong>regex</strong> operator.</p>
</li>
<li>
<p>If you cannot define the conditions that you need by using the basic expression builder,
see <a href="{LinkSyndesisIntegrationGuide}#using-advanced-expression-builder_condition">Using the advanced expression builder to specify conditions</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-advanced-expression-builder_condition"><a class="anchor" href="#using-advanced-expression-builder_condition"></a>Using the advanced expression builder to specify conditions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In a flow, add a <strong>Conditional Flows</strong> step when you want to evaluate
incoming data to determine the integration&#8217;s execution path. The procedure
described here shows how to use the advanced expression builder to
specify conditional expressions in Camel Simple Language.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You are creating or editing a primary flow. If this is a simple integration,
the start and finish connections have been added.</p>
</li>
<li>
<p>Input to a <strong>Conditional Flows</strong> step
must be an individual message. In the integration visualization,
if the previous step&#8217;s <strong>Data Type</strong> shows <strong>(Collection)</strong>, add a <strong>Split</strong> step.</p>
</li>
<li>
<p>You are familiar with the fields that will be in the messages that the
integration passes to the <strong>Conditional Flows</strong> step you are about to add.</p>
</li>
<li>
<p>You are familiar with the
<a href="http://camel.apache.org/simple.html">Camel Simple Expression</a> language
or you have expressions for the conditions that you want to evaluate.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the integration visualization, where you want to add a <strong>Conditional Flows</strong> step,
click <span class="image"><img src="../../../_images/images/integrating-applications/PlusSignToAddStepOrConnection.png" alt="PlusSignToAddStepOrConnection" title="plus sign"></span>.</p>
</li>
<li>
<p>Click <strong>Conditional Flows</strong>.</p>
</li>
<li>
<p>Click <strong>Select</strong> in the <strong>Advanced expression builder</strong> entry.</p>
</li>
<li>
<p>In the <strong>Configure Conditional Flows</strong> page, define one or more conditions:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the initial <strong>When</strong> field, enter a Camel Simple Language conditional expression. For example,
the following expression evaluates to true when the body of the message
contains a <code>pto</code> field that is greater than <code>160</code>:</p>
<div class="listingblock">
<div class="content">
<pre>${body.pto} &gt; 160</pre>
</div>
</div>
<div class="paragraph">
<p>When this expression evaluates to true, the integration executes the
conditional flow that you create and associate with this condition.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In an expression, an additional property specification is required when
the <strong>Conditional Flows</strong> step is in one of the following kinds of flows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An API provider integration operation flow</p>
</li>
<li>
<p>A simple integration that starts with a webhook connection</p>
</li>
<li>
<p>A simple integration that starts with a custom REST API connection</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In these flows, {prodname} wraps the actual message content inside a <code>body</code>
property. This means that the input to a <strong>Conditional Flows</strong> step contains a
<code>body</code> property that contains another <code>body</code> property that contains
the actual message content. Consequently, in an expression that is in a
<strong>Conditional Flows</strong> step that is in one of these kinds of flows,
you must specify two instances of <code>body</code>. For example, suppose you want
to evaluate content that is in the <code>pto</code> field of the input message.
Specify the expression like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>${body.body.pto} &gt; 160</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Optional. Click <strong>Add another condition</strong>, and repeat the previous
step. Do this for each additional condition that you want to define.</p>
</li>
<li>
<p>Optional. Change the order in which the <strong>Conditional Flows</strong> step evaluates
the defined conditions by clicking the up or down arrow to the right of a
condition field.</p>
</li>
<li>
<p>Optional. Click <strong>Execute default flow</strong> if you want there to be a
default conditional flow.</p>
<div class="paragraph">
<p>If you select <strong>Execute default flow</strong>, during execution,
if none of the conditions that you specified evaluates
to true, the integration executes the default conditional flow. If you do
not select <strong>Execute default flow</strong>, during execution, if none of the
conditions that you specified evaluates to true, the integration continues
execution with the step that follows this <strong>Conditional Flows</strong> step.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>Next</strong>.</p>
</li>
<li>
<p>Optional. Specify the output data type if {prodname} prompts for it.
All conditional flows that are part of this <strong>Conditional Flows</strong> step
must have the same output type.</p>
</li>
<li>
<p>Click <strong>Next</strong>.</p>
<div class="paragraph">
<p>{prodname} displays the flow visualization. Below the <strong>Conditional Flows</strong> step
that you are adding, there is an entry for each condition that you specified,
as well as an entry for an <strong>Otherwise</strong> default flow if you indicated that the
<strong>Conditional Flows</strong> step has a default flow.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Next step</div>
<p>For each condition, add steps to its associated flow. If there is a default flow,
add steps to the default flow.</p>
</div>
<div class="paragraph">
<div class="title">Additional resources</div>
<p><a href="https://camel.apache.org/manual/latest/simple-language.html#_operator_support">Camel Simple Language operators</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-steps-to-conditional-flows_condition"><a class="anchor" href="#adding-steps-to-conditional-flows_condition"></a>Adding steps to conditional flows</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In a <strong>Conditional Flows</strong> step, after you define conditions, for
each condition, add steps to the flow that is associated with that
condition. During execution, when the <strong>Conditional Flows</strong> step
evaluates a condition as true, it executes the flow that is associated
with that condition.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You defined the conditions for this <strong>Conditional Flows</strong> step.</p>
</li>
<li>
<p>You are familiar with the fields that will be in the messages that the
integration passes to this <strong>Conditional Flows</strong> step.</p>
</li>
<li>
<p>You created each connection that you want to add to a conditional flow.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the integration visualization, for the condition whose flow
you want to add to, click <strong>Open Flow</strong>.</p>
<div class="paragraph">
<p>{prodname} displays that condition near the top of the page.
The conditional flow visualization shows the <strong>Flow Start</strong> and
<strong>Flow End</strong> steps that all conditional flows have.</p>
</div>
</li>
<li>
<p>In the flow visualization, click
<span class="image"><img src="../../../_images/images/integrating-applications/PlusSignToAddStepOrConnection.png" alt="PlusSignToAddStepOrConnection" title="plus sign"></span>
where you want to add a step to this conditional flow.</p>
</li>
<li>
<p>Click the step that you want to add. You can add any connection or
step that you can add to a primary flow.</p>
<div class="paragraph">
<p>The output from the <strong>Flow Start</strong> step is always the same as the
output from the primary flow step that is before this <strong>Conditional Flows</strong> step.
For example, if you add a filter step or a data mapper step to this
conditional flow, the available fields are the same fields
that would be available in the primary flow.</p>
</div>
</li>
<li>
<p>Configure the step as needed.</p>
</li>
<li>
<p>Repeat the previous three instructions for each step that you
want to add to this conditional flow.</p>
</li>
<li>
<p>At the top of the page, in the <strong>Flow</strong> field,
click the down carat and click <strong>Back to primary flow</strong>, which saves
this conditional flow and displays the primary flow.</p>
</li>
<li>
<p>For each conditional flow that you want to add to,
repeat this procedure.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Results</div>
<p>The primary flow has a conditional flow for each condition that you
defined in the <strong>Conditional Flows</strong> step. If you selected the
<strong>Execute default flow</strong> option, the primary flow also has a default
conditional flow.</p>
</div>
<div class="paragraph">
<p>During execution, the <strong>Conditional Flows</strong> step executes the conditional
flow that is associated with the first condition that evaluates to true.
The integration then executes the step that follows the <strong>Conditional Flows</strong>
step.</p>
</div>
<div class="paragraph">
<p>If no condition evaluates to true then the <strong>Conditional Flows</strong> step
executes the default conditional flow. The integration then executes the
step that follows the <strong>Conditional Flows</strong> step.</p>
</div>
<div class="paragraph">
<p>If both of the following are true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No condition evaluates to true.</p>
</li>
<li>
<p>There is no default conditional flow.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then the integration executes the step that follows
the <strong>Conditional Flows</strong> step.</p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
