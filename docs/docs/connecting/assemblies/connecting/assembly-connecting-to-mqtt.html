<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Connecting to MQTT :: Docs</title>
    <meta name="generator" content="Antora 2.3.1">
    <link rel="stylesheet" href="../../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
         
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="is-primary" href="#"></a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../../index.html">Docs</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../index.html"> Home</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Docs</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../index.html">Docs</a></li>
    <li><a href="assembly-connecting-to-mqtt.html">Connecting to MQTT</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/pwright/repos/doc-test/syndesis/antora/modules/ROOT/pages/connecting/assemblies/connecting/assembly-connecting-to-mqtt.adoc"></a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Connecting to MQTT</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>MQ Telemetry Transport (MQTT) is a lightweight,
machine-to-machine, internet of things, connectivity protocol.
In an integration, you can obtain messages from or publish messages to
an MQTT broker. To do this, create a connection to the MQTT broker
of interest and then add that connection to an integration flow.
Details are in the following topics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#creating-mqtt-connections_mqtt">Creating a connection to an MQTT broker</a></p>
</li>
<li>
<p><a href="#adding-mqtt-connection-start_mqtt">Obtaining a message from an MQTT broker to trigger integration execution</a></p>
</li>
<li>
<p><a href="#adding-mqtt-connection-finish-middle_mqtt">Publishing a message to an MQTT broker</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-mqtt-connections_mqtt"><a class="anchor" href="#creating-mqtt-connections_mqtt"></a>Creating a connection to an MQTT broker</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In an integration, to obtain messages from or publish messages to
an MQTT broker, create a connection to the MQTT broker
of interest and then add that connection to an integration.</p>
</div>
<div class="paragraph">
<div class="title">Prerequisite</div>
<p>You must know the URL for the MQTT broker that you want to connect to.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In {prodname}, in the left panel, click <strong>Connections</strong> to
display any available connections.</p>
</li>
<li>
<p>Click <strong>Create Connection</strong> to display
connectors.</p>
</li>
<li>
<p>Click the <strong>MQTT Message Broker</strong> connector.</p>
</li>
<li>
<p>To configure the connection:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the <strong>MQTT broker URL</strong> field, enter the location of the MQTT broker
that you want to send data to or obtain data from. This is the only
required field.</p>
</li>
<li>
<p>In the <strong>User Name</strong> field, optionally enter the user name for the MQTT
account whose credentials you want to use to access the broker.</p>
</li>
<li>
<p>In the <strong>Password</strong> field, if you specified a user name, then specify the
password associated with that account.</p>
</li>
<li>
<p>In the <strong>Client ID</strong> field, optionally enter the ID that allows connections
to close and reopen without missing messages. The connection must
subscribe to or publish to a topic.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>Validate</strong>. {prodname} immediately tries to validate the
connection and displays a message that indicates whether
validation is successful. If validation fails, revise the input
parameters and try again.</p>
</li>
<li>
<p>If validation is successful, click <strong>Next</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter your choice of a name that
helps you distinguish this connection from any other connections.
For example, you might enter <code>MQTT West</code>.</p>
</li>
<li>
<p>In the <strong>Description</strong> field, optionally enter any information that
is helpful to know about this connection.</p>
</li>
<li>
<p>Click <strong>Save</strong> to see that the connection you
created is now available. If you
entered the example name, you would
see that <strong>MQTT West</strong> appears as a connection that you can
choose to add to an integration.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-mqtt-connection-start_mqtt"><a class="anchor" href="#adding-mqtt-connection-start_mqtt"></a>Obtaining a message from an MQTT broker to trigger integration execution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To trigger execution of an integration based on receiving a message
from an MQTT broker, add an MQTT connection as the start connection. When
the integration is running, the MQTT connection continuously watches for messages
on the MQTT queue or topic that you specify. When the connection finds a
message, it passes it to the next step in the integration. An MQTT
connection handles one message at a time.</p>
</div>
<div class="paragraph">
<div class="title">Prerequisite</div>
<p>You created an MQTT connection.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the {prodname} panel on the left, click <strong>Integrations</strong>.</p>
</li>
<li>
<p>Click <strong>Create Integration</strong>.</p>
</li>
<li>
<p>On the <strong>Choose a connection</strong> page, click the MQTT connection that
you want to use to start the integration.</p>
</li>
<li>
<p>On the <strong>Choose an action</strong> page, select the <strong>Subscribe</strong> action
to receive messages from the queue or topic that you specify.</p>
</li>
<li>
<p>In the <strong>MQTT queue/topic name</strong> field, enter the name of the queue or topic
to subscribe to in order to receive data.</p>
</li>
<li>
<p>Click <strong>Next</strong> to specify the action&#8217;s output type.</p>
</li>
<li>
<p>In the <strong>Select Type</strong> field, if the data type does not need to be known,
accept <strong>Type specification not required</strong>
and click <strong>Next</strong>. You do not need to follow the rest of these
instructions.</p>
<div class="paragraph">
<p>However, a structured data type is recommended. For example, if you want
to map the connection output in a data mapper step then you must specify
the data type. The data mapper cannot display fields for unstructured data.</p>
</div>
<div class="paragraph">
<p>To specify the data type, click in the <strong>Select Type</strong> field and select one of the following as the schema type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON schema</strong> is a document that describes the structure of JSON data.
The document&#8217;s media type is <code>application/schema+json</code>.</p>
</li>
<li>
<p><strong>JSON instance</strong> is a document that contains JSON data. The document&#8217;s
media type is <code>application/json</code>.</p>
</li>
<li>
<p><strong>XML schema</strong> is a document that describes the structure of XML data.
The document&#8217;s file extension is <code>.xsd</code>.</p>
</li>
<li>
<p><strong>XML instance</strong> is a document that contains XML data. The
document&#8217;s file extension is <code>.xml</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the <strong>Definition</strong> input box, paste a definition that conforms to the
schema type you selected.
For example, if you select <strong>JSON schema</strong> then you would paste the content of
a JSON schema file, which has a media type of <code>application/schema+json</code>.</p>
</li>
<li>
<p>In the <strong>Data Type Name</strong> field, enter a name that you choose for the
data type. For example, if you are specifying a JSON schema for
vendors then you might specify <code><strong>Vendor</strong></code> as the data type name.</p>
<div class="paragraph">
<p>You will see this data type name when you are creating
or editing an integration that uses the connection
for which you are specifying this type. {prodname} displays the type name
in the integration visualization and in the data mapper.</p>
</div>
</li>
<li>
<p>In the <strong>Data Type Description</strong> field, provide information that helps you
distinguish this type. This description appears in the data mapper when
you hover over the step that processes this type.</p>
</li>
<li>
<p>Click <strong>Next</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>The integration now has a start connection and {prodname} is
prompting you to choose the finish connection.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-mqtt-connection-finish-middle_mqtt"><a class="anchor" href="#adding-mqtt-connection-finish-middle_mqtt"></a>Publishing a message to an MQTT broker</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In an integration, you can publish a message to an MQTT broker
in the middle of a flow or to finish a simple integration.
To do this, add an MQTT connection to the middle of a flow or
as the integration&#8217;s finish connection.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You created an MQTT connection.</p>
</li>
<li>
<p>You are creating or editing a flow and {prodname} is prompting you
to add to the integration. Or, {prodname} is prompting you to choose a finish connection.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On the <strong>Add to Integration</strong> page, click the plus sign where you
want to add an MQTT connection. Skip this step if you are adding
a simple integration&#8217;s finish connection.</p>
</li>
<li>
<p>Click the MQTT connection that you want to use
to publish a message.</p>
</li>
<li>
<p>On the <strong>Choose an action</strong> page, select <strong>Publish</strong>.</p>
</li>
<li>
<p>In the <strong>MQTT queue/topic name</strong> field, specify the name of the queue or
topic to publish the message to.</p>
</li>
<li>
<p>Click <strong>Next</strong> to specify the action&#8217;s input type.</p>
</li>
<li>
<p>In the <strong>Select Type</strong> field, if the data type does not need to be known,
accept <strong>Type specification not required</strong>
and click <strong>Next</strong>. You do not need to follow the rest of these
instructions.</p>
<div class="paragraph">
<p>However, a structured data type is recommended. For example, if you want
to map the connection input in a data mapper step then you must specify
the data type. The data mapper cannot display fields for unstructured data.</p>
</div>
<div class="paragraph">
<p>To specify the data type, click in the <strong>Select Type</strong> field and select one of the following as the schema type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON schema</strong> is a document that describes the structure of JSON data.
The document&#8217;s media type is <code>application/schema+json</code>.</p>
</li>
<li>
<p><strong>JSON instance</strong> is a document that contains JSON data. The document&#8217;s
media type is <code>application/json</code>.</p>
</li>
<li>
<p><strong>XML schema</strong> is a document that describes the structure of XML data.
The document&#8217;s file extension is <code>.xsd</code>.</p>
</li>
<li>
<p><strong>XML instance</strong> is a document that contains XML data. The
document&#8217;s file extension is <code>.xml</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the <strong>Definition</strong> input box, paste a definition that conforms to the
schema type you selected.
For example, if you select <strong>JSON schema</strong> then you would paste the content of
a JSON schema file, which has a media type of <code>application/schema+json</code>.</p>
</li>
<li>
<p>In the <strong>Data Type Name</strong> field, enter a name that you choose for the
data type. For example, if you are specifying a JSON schema for
vendors then you might specify <code><strong>Vendor</strong></code> as the data type name.</p>
<div class="paragraph">
<p>You will see this data type name when you are creating
or editing an integration that uses the connection
for which you are specifying this type. {prodname} displays the type name
in the integration visualization and in the data mapper.</p>
</div>
</li>
<li>
<p>In the <strong>Data Type Description</strong> field, provide information that helps you
distinguish this type. This description appears in the data mapper when
you hover over the step that processes this type.</p>
</li>
<li>
<p>Click <strong>Next</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>The connection appears in the integration visualization
where you added it.</p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
