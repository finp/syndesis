<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Connecting to AMQ :: Docs</title>
    <meta name="generator" content="Antora 2.3.1">
    <link rel="stylesheet" href="../../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
         
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="is-primary" href="#"></a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../../index.html">Docs</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../index.html"> Home</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Docs</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../index.html">Docs</a></li>
    <li><a href="assembly-connecting-to-amq.html">Connecting to AMQ</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/pwright/repos/doc-test/syndesis/antora/modules/ROOT/pages/connecting/assemblies/connecting/assembly-connecting-to-amq.adoc"></a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Connecting to AMQ</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In an integration, you can obtain messages from a
Red Hat AMQ broker or publish messages to
a Red Hat AMQ broker. Red Hat AMQ uses the OpenWire protocol for communication
between clients and message brokers. To communicate with the following
broker types, use the Red Hat AMQ connector to create a connection to the
broker of interest:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Apache ActiveMQ broker that does not support AMQP</p>
</li>
<li>
<p>AMQ 6 broker</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To communicate with one of the following broker types,
<a href="{LinkSyndesisConnectorGuide}#connecting-to-amqp_amqp">use the AMQP connector</a>
to create a connection to the broker of interest:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Apache ActiveMQ broker that supports AMQP</p>
</li>
<li>
<p>Apache ActiveMQ Artemis</p>
</li>
<li>
<p>AMQ 7 broker</p>
</li>
<li>
<p>EnMasse, which is an open source messaging platform</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To use the Red Hat AMQ connector, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#create-amq-connection_amq">Creating an AMQ connection</a></p>
</li>
<li>
<p><a href="#adding-amq-connection-start_amq">Adding an AMQ connection to trigger integration execution upon receiving messages</a></p>
</li>
<li>
<p><a href="#adding-amq-connection-finish_amq">Publishing AMQ messages to finish an integration</a></p>
</li>
<li>
<p><a href="#adding-amq-connection-middle_amq">Publishing AMQ messages in the middle of an integration</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-amq-connection_amq"><a class="anchor" href="#create-amq-connection_amq"></a>Creating an AMQ connection</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In an integration, to obtain messages from or to publish messages to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An Apache ActiveMQ broker that does not support AMQP</p>
</li>
<li>
<p>An  AMQ 6 broker</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Create a Red Hat AMQ connection, which you can add to an integration.</p>
</div>
<div class="paragraph">
<div class="title">Prerequisites</div>
<p>For the Red Hat AMQ broker that you want to connect to, you have the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Broker URL</p>
</li>
<li>
<p>User account credentials</p>
</li>
<li>
<p>Broker&#8217;s PEM certificate text</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In {prodname}, in the left panel, click <strong>Connections</strong> to
display any available connections.</p>
</li>
<li>
<p>Click <strong>Create Connection</strong> to display
connectors.</p>
</li>
<li>
<p>Click the <strong>Red Hat AMQ</strong> connector.</p>
</li>
<li>
<p>Configure the connection:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the <strong>Broker URL</strong> field, enter the location that you want to send data
to or obtain data from, for example, <code>tcp://localhost:61616</code>.</p>
</li>
<li>
<p>In the <strong>User name</strong> field, enter the user name for the account that you want
to use to access this broker.</p>
</li>
<li>
<p>In the <strong>Password</strong> field, enter the password for the account that you want
to use to access this broker.</p>
</li>
<li>
<p>In the <strong>Client ID</strong> field, enter the ID that allows connections to close
and reopen without missing messages. The destination type must be a topic.</p>
</li>
<li>
<p>If this connection will be used in a development
environment, you can save some time by disabling
<strong>Check certificates</strong>. Disabling the checking of certificates is a convenience for
development environments. For secure production environments, always enable
<strong>Check certificates</strong>.</p>
</li>
<li>
<p>In the <strong>Broker certificate</strong> field, paste the Red Hat AMQ broker&#8217;s PEM certificate text.
This is required except when you disable
checking the certificates.</p>
</li>
<li>
<p>In the <strong>Client certificate</strong> field, paste the Red Hat client&#8217;s PEM certificate text.
Content in this field is always optional.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>Validate</strong>. {prodname} immediately tries to validate the
connection and displays a message that indicates whether
validation is successful. If validation fails, revise the configuration
details as needed and try again.</p>
</li>
<li>
<p>If validation is successful, click <strong>Next</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter your choice of a name that
helps you distinguish this connection from any other connections.
For example, you might enter <code>Red Hat AMQ 1</code>.</p>
</li>
<li>
<p>In the <strong>Description</strong> field, optionally enter any information that
is helpful to know about this connection. For example,
enter <code><strong>Sample Red Hat AMQ connection
that uses a provided broker.</strong></code></p>
</li>
<li>
<p>Click <strong>Save</strong> to see that the connection you
created is now available. If you
entered the example name, you would
see that <strong>Red Hat AMQ 1</strong> appears as a connection that you can
choose to add to an integration.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-amq-connection-start_amq"><a class="anchor" href="#adding-amq-connection-start_amq"></a>Adding an AMQ connection to trigger integration execution upon receiving messages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To trigger execution of an integration upon receiving a message
from a Red Hat AMQ broker, add a Red Hat AMQ connection as the start connection.</p>
</div>
<div class="paragraph">
<div class="title">Prerequisite</div>
<p>You created a Red Hat AMQ connection to the Red Hat AMQ broker that you want to obtain
messages from.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the {prodname} panel on the left, click <strong>Integrations</strong>.</p>
</li>
<li>
<p>Click <strong>Create Integration</strong>.</p>
</li>
<li>
<p>On the <strong>Choose a connection</strong> page, click the Red Hat AMQ connection that
you want to use to start the integration.</p>
</li>
<li>
<p>On the <strong>Choose an action</strong> page, select the <strong>Subscribe for messages</strong> action
to receive messages from the queue or topic that you specify.</p>
</li>
<li>
<p>Configure the action:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the <strong>Destination name</strong> field, enter the name of the queue or topic
to receive data from.</p>
</li>
<li>
<p>For the <strong>Destination type</strong>, accept <strong>Queue</strong> or select <strong>Topic</strong>.</p>
</li>
<li>
<p>In the <strong>Durable subscription ID</strong> field, to allow connections to
close and reopen without missing messages, enter the durable
subscription ID. The destination type must be a topic.</p>
</li>
<li>
<p>In the <strong>Message selector</strong> field, if you want to receive only
data that satisfies a particular condition, enter a filter expression.</p>
<div class="paragraph">
<p>A message selector is a string that contains an expression. The syntax of
the expression is based on a subset of the SQL92 conditional expression syntax.
The message selector in the following example selects any message that has a
<code>NewsType</code> property whose value is set to <code>Sports</code> or <code>Opinion</code>:</p>
</div>
<div class="paragraph">
<p><code>NewsType = ’Sports’ OR NewsType = ’Opinion’</code></p>
</div>
<div class="paragraph">
<p>The message consumer receives only those messages whose headers and
properties match the message selector expression. A message selector cannot select messages on
the basis of the content of the message body.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>Next</strong> to specify the action&#8217;s output type.</p>
</li>
<li>
<p>In the <strong>Select Type</strong> field, if the data type does not need to be known,
accept <strong>Type specification not required</strong>
and click <strong>Next</strong>. You do not need to follow the rest of these
instructions.</p>
<div class="paragraph">
<p>However, a structured data type is recommended. For example, if you want
to map the connection output in a data mapper step then you must specify
the data type. The data mapper cannot display fields for unstructured data.</p>
</div>
<div class="paragraph">
<p>To specify the data type, click in the <strong>Select Type</strong> field and select one of the following as the schema type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON schema</strong> is a document that describes the structure of JSON data.
The document&#8217;s media type is <code>application/schema+json</code>.</p>
</li>
<li>
<p><strong>JSON instance</strong> is a document that contains JSON data. The document&#8217;s
media type is <code>application/json</code>.</p>
</li>
<li>
<p><strong>XML schema</strong> is a document that describes the structure of XML data.
The document&#8217;s file extension is <code>.xsd</code>.</p>
</li>
<li>
<p><strong>XML instance</strong> is a document that contains XML data. The
document&#8217;s file extension is <code>.xml</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the <strong>Definition</strong> input box, paste a definition that conforms to the
schema type you selected.
For example, if you select <strong>JSON schema</strong> then you would paste the content of
a JSON schema file, which has a media type of <code>application/schema+json</code>.</p>
</li>
<li>
<p>In the <strong>Data Type Name</strong> field, enter a name that you choose for the
data type. For example, if you are specifying a JSON schema for
vendors then you might specify <code><strong>Vendor</strong></code> as the data type name.</p>
<div class="paragraph">
<p>You will see this data type name when you are creating
or editing an integration that uses the connection
for which you are specifying this type. {prodname} displays the type name
in the integration visualization and in the data mapper.</p>
</div>
</li>
<li>
<p>In the <strong>Data Type Description</strong> field, provide information that helps you
distinguish this type. This description appears in the data mapper when
you hover over the step that processes this type.</p>
</li>
<li>
<p>Click <strong>Next</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>The connection appears at the beginning of the integration flow.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-amq-connection-finish_amq"><a class="anchor" href="#adding-amq-connection-finish_amq"></a>Publishing AMQ messages to finish an integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To finish a simple integration by publishing messages to a Red Hat AMQ broker,
add a Red Hat AMQ connection as the simple integration&#8217;s finish connection.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You created a connection to the Red Hat AMQ broker that you want to publish
messages to.</p>
</li>
<li>
<p>You are creating an integration and {prodname} is prompting you
to choose the
finish connection, or you are editing an integration to change the finish
connection.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On the <strong>Choose a connection</strong> page, click the Red Hat AMQ connection that
you want to use to finish the integration.</p>
</li>
<li>
<p>On the <strong>Choose an action</strong> page, select the <strong>Publish messages</strong> action to
publish messages to the queue or topic that you specify.</p>
</li>
<li>
<p>In the <strong>Destination name</strong> field, enter the name of the queue or
topic to send messages to.</p>
</li>
<li>
<p>For the <strong>Destination type</strong>, accept <strong>Queue</strong> or select <strong>Topic</strong>.</p>
</li>
<li>
<p>Select <strong>Persistent</strong> to guarantee message delivery even if
a connection fails.</p>
</li>
<li>
<p>Click <strong>Next</strong> to specify the action&#8217;s input/output type.</p>
</li>
<li>
<p>In the <strong>Select Type</strong> field, if the data type does not need to be known,
accept <strong>Type specification not required</strong>
and click <strong>Next</strong>. You do not need to follow the rest of these
instructions.</p>
<div class="paragraph">
<p>However, a structured data type is recommended. For example, if you want
to map the connection input/output in a data mapper step then you must specify
the data type. The data mapper cannot display fields for unstructured data.</p>
</div>
<div class="paragraph">
<p>To specify the data type, click in the <strong>Select Type</strong> field and
select one of the following as the schema type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON schema</strong> is a document that describes the structure of JSON data.
The document&#8217;s media type is <code>application/schema+json</code>.</p>
</li>
<li>
<p><strong>JSON instance</strong> is a document that contains JSON data. The document&#8217;s
media type is <code>application/json</code>.</p>
</li>
<li>
<p><strong>XML schema</strong> is a document that describes the structure of XML data.
The document&#8217;s file extension is <code>.xsd</code>.</p>
</li>
<li>
<p><strong>XML instance</strong> is a document that contains XML data. The
document&#8217;s file extension is <code>.xml</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the <strong>Definition</strong> input box, paste a definition that conforms to the
schema type you selected.
For example, if you select <strong>JSON schema</strong> then you would paste the content of
a JSON schema file, which has a media type of <code>application/schema+json</code>.</p>
</li>
<li>
<p>In the <strong>Data Type Name</strong> field, enter a name that you choose for the
data type. For example, if you are specifying a JSON schema for
vendors then you might specify <code><strong>Vendor</strong></code> as the data type name.</p>
<div class="paragraph">
<p>You will see this data type name when you are creating
or editing an integration that uses the connection
for which you are specifying this type. {prodname} displays the type name
in the integration visualization and in the data mapper.</p>
</div>
</li>
<li>
<p>In the <strong>Data Type Description</strong> field, provide information that helps you
distinguish this type. This description appears in the data mapper when
you hover over the step that processes this type.</p>
</li>
<li>
<p>Click <strong>Next</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>The connection appears at the end of the integration visualization.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-amq-connection-middle_amq"><a class="anchor" href="#adding-amq-connection-middle_amq"></a>Publishing AMQ messages in the middle of an integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the middle of an integration, to publish messages to a Red Hat AMQ broker,
add a Red Hat AMQ connection to the middle of a flow.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You created a connection to the Red Hat AMQ broker that you want to publish messages to.</p>
</li>
<li>
<p>You are creating or editing a flow and {prodname} is prompting you
to add to the integration. Or, {prodname} is prompting you to choose a finish connection.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On the <strong>Add to Integration</strong> page, click the plus sign where you
want to add the connection. Skip this step if {prodname} is
prompting you to choose the finish connection.</p>
</li>
<li>
<p>Click the Red Hat AMQ connection that you
want in the middle of the flow.</p>
</li>
<li>
<p>On the <strong>Choose an action</strong> page, select one of the following actions:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Publish messages</strong> to
publish messages to the queue or topic that you specify. To configure this
action:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the <strong>Destination name</strong> field, enter the name of the queue or
topic to send messages to.</p>
</li>
<li>
<p>For the <strong>Destination type</strong>, accept <strong>Queue</strong> or select <strong>Topic</strong>.</p>
</li>
<li>
<p>Select <strong>Persistent</strong> to guarantee message delivery even if
a connection fails.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Request response using messages</strong> to send messages to the JMS destination that
you specify and receive a response. To configure this action:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the <strong>Destination name</strong> field, enter the name of the queue or topic
to send messages to.</p>
</li>
<li>
<p>For the <strong>Destination type</strong>, accept <strong>Queue</strong> or select <strong>Topic</strong>.</p>
</li>
<li>
<p>In the <strong>Message selector</strong> field, if you want to receive only responses
that satisfy a particular condition, enter a filter expression.</p>
<div class="paragraph">
<p>A message selector is a string that contains an expression. The syntax of
the expression is based on a subset of the SQL92 conditional expression syntax.
The message selector in the following example selects any message that has a
<code>NewsType</code> property whose value is set to <code>Sports</code> or <code>Opinion</code>:</p>
</div>
<div class="paragraph">
<p><code>NewsType = ’Sports’ OR NewsType = ’Opinion’</code></p>
</div>
<div class="paragraph">
<p>The message consumer receives only those messages whose headers and
properties match the message selector expression. A message selector cannot select messages on
the basis of the content of the message body.</p>
</div>
</li>
<li>
<p>In the <strong>Named reply to</strong> field, enter the name of
a queue or topic. The destination sends its response
to this queue or topic.</p>
</li>
<li>
<p>Select <strong>Persistent</strong> to guarantee message delivery even if
a connection fails.</p>
</li>
<li>
<p>In the <strong>Response time out</strong> field, specify the number of milliseconds that this
connection waits for a
response message before throwing a runtime exception.
The default is 5000 milliseconds (5 seconds).</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Next</strong> to specify the action&#8217;s input type and then the action&#8217;s
output type.</p>
</li>
<li>
<p>In the <strong>Select Type</strong> field, if the data type does not need to be known,
accept <strong>Type specification not required</strong>
and click <strong>Next</strong>. You do not need to follow the rest of these
instructions.</p>
<div class="paragraph">
<p>However, a structured data type is recommended. For example, if you want
to map the connection input/output in a data mapper step then you must specify
the data type. The data mapper cannot display fields for unstructured data.</p>
</div>
<div class="paragraph">
<p>To specify the data type, click in the <strong>Select Type</strong> field and select one of the following as the schema type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON schema</strong> is a document that describes the structure of JSON data.
The document&#8217;s media type is <code>application/schema+json</code>.</p>
</li>
<li>
<p><strong>JSON instance</strong> is a document that contains JSON data. The document&#8217;s
media type is <code>application/json</code>.</p>
</li>
<li>
<p><strong>XML schema</strong> is a document that describes the structure of XML data.
The document&#8217;s file extension is <code>.xsd</code>.</p>
</li>
<li>
<p><strong>XML instance</strong> is a document that contains XML data. The
document&#8217;s file extension is <code>.xml</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the <strong>Definition</strong> input box, paste a definition that conforms to the
schema type you selected.
For example, if you select <strong>JSON schema</strong> then you would paste the content of
a JSON schema file, which has a media type of <code>application/schema+json</code>.</p>
</li>
<li>
<p>In the <strong>Data Type Name</strong> field, enter a name that you choose for the
data type. For example, if you are specifying a JSON schema for
vendors then you might specify <code><strong>Vendor</strong></code> as the data type name.</p>
<div class="paragraph">
<p>You will see this data type name when you are creating
or editing an integration that uses the connection
for which you are specifying this type. {prodname} displays the type name
in the integration visualization and in the data mapper.</p>
</div>
</li>
<li>
<p>In the <strong>Data Type Description</strong> field, provide information that helps you
distinguish this type. This description appears in the data mapper when
you hover over the step that processes this type.</p>
</li>
<li>
<p>Click <strong>Next</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>The connection appears in the integration visualization where you added it.</p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
