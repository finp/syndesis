<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Adding a pivot table to a sheet :: Docs</title>
    <meta name="generator" content="Antora 2.3.1">
    <link rel="stylesheet" href="../../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
         
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="is-primary" href="#"></a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../../index.html">Docs</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../index.html"> Home</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Docs</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../index.html">Docs</a></li>
    <li><a href="proc-add-google-sheets-connection-add-pivot-table.html">Adding a pivot table to a sheet</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/pwright/repos/doc-test/syndesis/antora/modules/ROOT/pages/connecting/modules/connecting/proc-add-google-sheets-connection-add-pivot-table.adoc"></a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Adding a pivot table to a sheet</h1>
<div class="paragraph">
<p>In the middle of a flow, or to finish a simple integration,
you can add a pivot table to a Google Sheets spreadsheet.
A pivot table lets you aggregate, sort, or apply a function to
spreadsheet data and display the results in the same spreadsheet.
To add a pivot table, add a Google Sheets connection to the middle of a flow
or as a simple integration&#8217;s finish connection. Then add a data mapping
step before the connection. In the data mapping step, you set
options that determine the location, properties, and content of the
pivot table.</p>
</div>
<div class="paragraph">
<p>In this release, the <strong>Add pivot table</strong> action is limited to defining
one value group, one row pivot group, and one column pivot group.
Support for multiple groups in a single action is expected to be
added in a future release. As a workaround, you can add multiple
Google Sheets connections that add pivot tables based on the same
source spreadsheet.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You created a Google Sheets connection that is authorized to access
the Google spreadsheet that you want to add a pivot table to.</p>
</li>
<li>
<p>You have access to the ID for the spreadsheet that contains the source
data for the pivot table.</p>
</li>
<li>
<p>You are creating or editing a flow and {prodname} is prompting you
to add to the integration.  Or, {prodname} is prompting you to choose the finish
connection for a simple integration.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On the <strong>Add to Integration</strong> page, click the plus sign where you
want to add the connection. Skip this step if {prodname} is
prompting you to choose the finish connection.</p>
</li>
<li>
<p>Click a Google Sheets connection that is authorized to access
the spreadsheet that you want to add the pivot table to.</p>
</li>
<li>
<p>On the <strong>Choose an action</strong> page, select <strong>Add pivot tables</strong>.</p>
</li>
<li>
<p>To configure the <strong>Add pivot tables</strong> action, in the
<strong>SpreadsheetId</strong> field, do one of the following:</p>
<div class="ulist">
<ul>
<li>
<p>Enter the ID of the spreadsheet that you want to add a pivot table to.</p>
</li>
<li>
<p>Leave the field blank. In the data mapper step that you will add just
before this connection, you will map the spreadsheet ID from
a previous connection to this connection. The previous connection must
access the spreadsheet that you want to add a pivot table to in this connection.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Next</strong> to add the connection to the flow.
The connection appears in the integration visualization
where you added it.</p>
</li>
<li>
<p>If you want to add any other connections to this flow, add them
now. Then return to these instructions.</p>
</li>
<li>
<p>In the integration visualization, click the plus sign that is
just before the connection that adds a pivot table to a sheet.</p>
</li>
<li>
<p>Click <strong>Data Mapper</strong>.</p>
<div class="paragraph">
<p>In the data mapper, map source properties, source fields, or source constants to the target
Google Sheets connection, which is adding a pivot table. The following instructions
assume that there is a source field, source property, or source constant that contains the
value that you want to map to each target field.</p>
</div>
<div class="paragraph">
<p>If there is no source
for the required value, then create a source property
in the data mapper by clicking the + sign that is to the right of the
<strong>Properties</strong> folder. In the <strong>Create Property</strong> dialog, give the property
a name that makes it easy to map to the correct target field, for example,
specify <strong><code>valueLayout</code></strong> as the property name.
Specify the value that you want the connection to use to create the
pivot table. The pivot table&#8217;s value layout field requires a value of <code>HORIZONTAL</code>
or <code>VERTICAL</code> so you might specify <code>VERTICAL</code> as the value of the
<strong>valueLayout</strong> property. Save the new property.</p>
</div>
</li>
<li>
<p>In the data mapper, configure a new pivot table as follows:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Map a source <strong>spreadsheetId</strong> field to the target <strong>spreadsheetId</strong> field.
The connection uses source data in this spreadsheet to add the pivot
table to a sheet in this same spreadsheet. The source data and the pivot
table can be in two different sheets in the same spreadsheet but they
cannot be in two different spreadsheets.</p>
</li>
<li>
<p>Identify the sheet to add the pivot table to by mapping an integer to the
<strong>sheetId</strong> field. The default is <code>0</code>, which identifies the first sheet
in the spreadsheet.
For subsequent sheets, the sheet ID is at the end of the URL when the
sheet is visible in a browser. For example, at the end of the following URL,
you can <code>gid=206589330</code>:</p>
<div class="paragraph">
<p><code>https://docs.google.com/spreadsheets/d/1pa&#8230;&#8203;ngQbKkM/edit#gid=206589330</code>.</p>
</div>
<div class="paragraph">
<p>This indicates that the sheet ID is <code>206589330</code> and that is the value
that you would map to <strong>sheetId</strong>.</p>
</div>
</li>
<li>
<p>Identify the sheet that provides the data for generating the pivot table by mapping
its integer sheet ID to the target <strong>sourceSheetId</strong> field.
If you do not map a value to <strong>sourceSheetId</strong>,
the connection uses the <strong>sheetId</strong> value, or <code>0</code> if no value is mapped
to <strong>sheetId</strong>. <code>0</code> identifies the first sheet in the spreadsheet.</p>
</li>
<li>
<p>Set the source data range for generating the pivot table
by mapping an A1 notation value to the target <strong>sourceRange</strong> field.
For example, <strong>A2:D5</strong>.</p>
</li>
<li>
<p>Set the value layout to be used on the pivot table by mapping to the
target <strong>valueLayout</strong> field. The value must be <code>VERTICAL</code> or <code>HORIZONTAL</code>, which
is the default. <code>HORIZONTAL</code> specifies that values are laid out as columns.</p>
</li>
<li>
<p>Set the top left cell of the pivot table by mapping an A1 notation
cell coordinate to the target <strong>start</strong> field.
When the connection adds the pivot table to the sheet that contains
the source data, if you do not map a value to the <strong>start</strong> field,
the default is that the top left cell of the pivot table is the cell
that is in the first row of the source data range and in the first
empty column after the source data range. When the source data is
in one sheet and the pivot table will be in another sheet, the default is <strong>A1</strong>.</p>
</li>
<li>
<p>To add a value group, expand <strong>valueGroups</strong>
in the target panel, and map values to the
fields under <strong>valueGroups</strong>:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Map a value group name to the target <strong>name</strong> field.</p>
</li>
<li>
<p>Map a function, which you want to apply to the value group, to the target <strong>function</strong> field.
The value must be <code>SUM</code>, <code>COUNT</code>, <code>AVERAGE</code>, <code>MAX</code>, <code>MIN</code>, or <code>CUSTOM</code>.
The default is <code>SUM</code>. Map <code>CUSTOM</code> to <strong>function</strong> when you are defining a formula.</p>
</li>
<li>
<p>Map a custom formula, which you want to apply to the value group, to the target
<strong>formula</strong> field if you mapped the <code>CUSTOM</code> value to the <strong>function</strong> field.</p>
</li>
<li>
<p>Map a column name, which is the coordinate that builds the value group,
to the target <strong>sourceColumn</strong> field.</p>
</li>
</ol>
</div>
</li>
<li>
<p>To add a row pivot group, expand <strong>columnGroups</strong>
in the target panel, and map values to the
fields under <strong>columnGroups</strong>:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Map a row pivot group name to the target <strong>label</strong> field.</p>
</li>
<li>
<p>Map the sort order that you want to apply to the row pivot group to the
target <strong>sortOrder</strong> field. The value must be <code>ASCENDING</code> or <code>DESCENDING</code>.
The default is <code>ASCENDING</code>.</p>
</li>
<li>
<p>Map <code>true</code> or <code>false</code> to the target <strong>showTotals</strong> field. The default
is <code>true</code>, which enables the display of totals for the row pivot group.</p>
</li>
<li>
<p>Map a column name, which is the coordinate that builds the row pivot group,
to the target <strong>sourceColumn</strong> field.</p>
</li>
</ol>
</div>
</li>
<li>
<p>To add a column pivot group, expand <strong>rowGroups</strong>
in the target panel, and map values to the
fields under <strong>rowGroups</strong>:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Map a column pivot group name to the target <strong>label</strong> field.</p>
</li>
<li>
<p>Map the sort order that you want to apply to the column pivot group to the
target <strong>sortOrder</strong> field. The value must be <code>ASCENDING</code> or <code>DESCENDING</code>.
The default is <code>ASCENDING</code>.</p>
</li>
<li>
<p>Map <code>true</code> or <code>false</code> to the target <strong>showTotals</strong> field. The default
is <code>true</code>, which enables the display of totals for the column pivot group.</p>
</li>
<li>
<p>Map a column name, which is the coordinate that builds the column pivot group,
to the target <strong>sourceColumn</strong> field.</p>
</li>
</ol>
</div>
</li>
<li>
<p>In the upper right, click <strong>Done</strong> to add the data mapper step.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Additional resource</div>
<p><a href="https://developers.google.com/sheets/api/guides/pivot-tables">Google developers documentation for pivot tables</a></p>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
