<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Obtaining spreadsheet data to trigger an integration or in the middle of a flow :: Docs</title>
    <meta name="generator" content="Antora 2.3.1">
    <link rel="stylesheet" href="../../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
         
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="is-primary" href="#"></a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../../index.html">Docs</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../index.html"> Home</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Docs</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../index.html">Docs</a></li>
    <li><a href="proc-add-google-sheets-connection-get-sheet-values.html">Obtaining spreadsheet data to trigger an integration or in the middle of a flow</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/pwright/repos/doc-test/syndesis/antora/modules/ROOT/pages/connecting/modules/connecting/proc-add-google-sheets-connection-get-sheet-values.adoc"></a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Obtaining spreadsheet data to trigger an integration or in the middle of a flow</h1>
<div class="paragraph">
<p>To trigger execution of an integration upon obtaining data from a
Google Sheets spreadsheet, add a Google Sheets connection to a simple integration
as its start connection. When the integration is running, the Google Sheets
connection polls the spreadsheet at the interval that you specified, obtains
the data that you identified, and passes the data to the next step in the
integration.</p>
</div>
<div class="paragraph">
<p>To obtain spreadsheet data in the middle of a flow, add a Google Sheets
connection as a middle connection. During execution, {prodname} polls
the spreadsheet for the specified data as soon as it starts processing
this connection. In other words, the connection does not wait for an
interval to elapse before polling the spreadsheet.</p>
</div>
<div class="paragraph">
<p>To obtain data from a particular sheet in a spreadsheet, you specify the
sheet name when you configure the action for the
Google Sheets connection. A particular connection can obtain data from
only one sheet.</p>
</div>
<div class="paragraph">
<p>Between polls, if there are no changes to the sheet values that the
connection is configured to return, then
the next poll returns the same values as the previous poll.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You created a Google Sheets connection that is authorized to access
the spreadsheet that you want to obtain data from.</p>
</li>
<li>
<p>If this Google Sheets connection is triggering integration execution,
then you are creating an integration and {prodname} is prompting you
to choose the start connection.</p>
</li>
<li>
<p>If this Google Sheets connection is in the middle of a flow,
then the integration already has a start connection and a finish
connection, and {prodname} is prompting you to add to the integration by choosing a step.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Click the Google Sheets connection that you want to use.</p>
</li>
<li>
<p>On the <strong>Choose an action</strong> page, for a start connection, select the
<strong>Get sheet values</strong> action or for a middle connection, select the
<strong>Retrieve sheet values</strong> action.</p>
</li>
<li>
<p>To configure the action:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the <strong>SpreadsheetId</strong> field, enter the ID of a Google spreadsheet that is
accessible from the Google account that this Google Sheets connection
is authorized to access.</p>
<div class="paragraph">
<p>To obtain a spreadsheet ID, display the spreadsheet in a browser.
The ID is the part of the URL between <code>d/</code> and <code>/edit</code>.</p>
</div>
</li>
<li>
<p>In the <strong>Range</strong> field, enter Google A1 notation that identifies
the data that you want to obtain. The default is <strong>A:A</strong>.</p>
<div class="paragraph">
<p>For example, suppose that you want all data from a spreadsheet that
has one sheet with 4 columns. Specify <code>A:D</code>. Or, to obtain data from
rows 5 through 15, specify <code>A5:D15</code>.</p>
</div>
<div class="paragraph">
<p>If the spreadsheet from which you are
obtaining data has more than one sheet, specify the sheet name as well
as the start cell coordinate and the end cell coordinate. If there is more
than one sheet, and you do not
specify a sheet name, then the connection obtains data from the first
sheet in the spreadsheet. For example, specification of <code>2019!A1:D5</code> specifies
that you want to obtain data from the sheet whose name is <code>2019</code>. In that
sheet, you want the data that is in columns A through D for rows 1 through 5.</p>
</div>
</li>
<li>
<p>In the <strong>Major dimension</strong> field, accept <strong>Rows</strong>, which is the default, or
select <strong>Columns</strong>.</p>
<div class="paragraph">
<p><strong>Rows</strong> configures the action to return a collection
of row objects where each row object contains a value for each desired column.
When <strong>Major dimension</strong> is <strong>Rows</strong>, {prodname} can display meaningful column
headings as field names in the data mapper, rather than <strong>A</strong>, <strong>B</strong>, <strong>C</strong>, and so on.</p>
</div>
<div class="paragraph">
<p><strong>Columns</strong> configures the action to return a collection of column objects
where each column object contains a value for each desired row.</p>
</div>
</li>
<li>
<p>In the <strong>Header row number</strong> field, if <strong>Major dimension</strong> is set to <strong>Rows</strong>,
optionally enter the number of the row that contains the column headings in
the data that the connection obtains. Specification of a header row enables
{prodname} to obtain the headings from the spreadsheet. If you do not
specify a header row, column headings default to a letter heading for
each column in the range of data that the connection obtains.
You can edit obtained headings or letter headings in the subsequent page.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are configuring a Google Sheets middle connection, the rest of
the configuration options are not needed and {prodname} does not
prompt for them. Skip to step 4.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>In the <strong>Split results</strong> field, accept <strong>No</strong>, which is the default, or
select <strong>Yes</strong>. A setting of <strong>No</strong> configures the action to
return data as a collection of values. That is,
the connection passes a collection of row objects or a collection of
column objects to the next step in the flow.
Select <strong>Yes</strong> to enable the connection to split the returned data
according to the setting of <strong>Major dimension</strong>. For example, if
<strong>Major dimension</strong> is set to <strong>Rows</strong> then the connection returns row
objects. Each row object triggers a separate execution of the flow.
That is, {prodname} executes the flow once for each returned row
object. For example, if the poll returns 5 rows then {prodname} executes
the flow 5 times.</p>
<div class="paragraph">
<p>{prodname} also provides discrete split and aggregate steps, which
you can add to a flow.
If you want to process individual objects in one or more steps and
then aggregate the row or column objects, do not split the Google Sheets
connection result. Instead, accept the default, <strong>No</strong>, and then add a
split step to the flow after this connection. A split step is
required if you want an aggregate step in the flow.</p>
</div>
</li>
<li>
<p>In the <strong>Delay</strong> field, accept the default of 30 seconds or
specify how often you want the connection to obtain spreadsheet data.</p>
</li>
<li>
<p>In the <strong>Max results</strong> field, accept the default of <strong>0</strong> if you do not
want to restrict how many rows or columns polling can return. The setting
of <strong>Max results</strong> applies to the setting of the major dimension in the
result matrix. To limit the data that the connection returns for the
major dimension, specify an integer.</p>
<div class="paragraph">
<p>For example, suppose that the major dimension is rows and that <strong>Max results</strong>
is set to <strong>25</strong>. The poll returns no more than 25 rows of values.</p>
</div>
<div class="paragraph">
<p>When <strong>Range</strong> specifies the major dimension and you also specify
<strong>Max results</strong>, polling uses the lower number to determine how much
data to return. Consequently, setting a value for <strong>Max results</strong> is
more helpful when you specify only the minor dimension for <strong>Range</strong>.
For example, consider a sheet that has 30 rows with three columns of
values in each row. Suppose that <strong>Major dimension</strong> is <strong>Rows</strong> and
<strong>Range</strong> is <strong>A:C</strong>. If you set <strong>Max results</strong> to <strong>10</strong>, polling returns
10 rows of data. If you accept <strong>0</strong> as the setting of <strong>Max results</strong>,
polling returns 30 rows. However, if you specify <strong>Range</strong> as <strong>A1:C15</strong>
and you also specify <strong>Max results</strong> as <strong>25</strong>, polling returns 15
rows. If you specify <strong>Range</strong> as <strong>A1:C30</strong> and you also
specify <strong>Max results</strong> as <strong>25</strong>, polling returns 25 rows.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>Next</strong> to view the column names in the data that the connection
obtains when <strong>Major dimension</strong> is set to <strong>Rows</strong>. If <strong>Major dimension</strong> is
<strong>Columns</strong>, content in this field is ignored and you can click <strong>Next</strong>
now to complete this procedure.</p>
<div class="paragraph">
<p>The values that appear in the <strong>Column names</strong> field become the
field names that a data mapper step displays. If you specified a
header row number, {prodname} displays the headings from that
row in the sheet that you are obtaining data from. If you left
the header row number field blank, {prodname} displays a letter
(<strong>A</strong>, <strong>B</strong>, <strong>C</strong>, and so on) for each column in the range of
data that you are obtaining.</p>
</div>
</li>
<li>
<p>Optionally, edit the <strong>Column names</strong> field so it contains the
field names that you want to see in a data mapper step.
The field must contain a comma-separated list with no spaces,
for example, <code>Name,Address,City,State,Zip</code>.</p>
</li>
<li>
<p>Click <strong>Next</strong> to add this Google Sheets connection to the flow.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Next steps</div>
<p>If you added a Google Sheets connection as a start connection, {prodname}
prompts you to add the
integration&#8217;s finish connection. With the start and finish connections
in the integration, add any other connections that you want in the
integration.</p>
</div>
<div class="paragraph">
<p>After the connection that obtains sheet values,
add a data mapper step. In the data mapper, {prodname} displays
source fields according to how you configure the action that obtains spreadsheet values.
That is, if the major dimension is <strong>Rows</strong>, then the data mapper lists
the column names as fields that you can map to the target. If the major
dimension is <strong>Columns</strong>, then the data mapper lists row indexes as
fields that you can map to the target.</p>
</div>
<div class="paragraph">
<div class="title">Additional resource</div>
<p><a href="https://developers.google.com/sheets/api/guides/concepts#a1_notation">Google A1 notation</a>
for specifying groups of cells in a spreadsheet</p>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
